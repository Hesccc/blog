{% extends 'manage/m_base.html' %}
{% block title %}{{ website_title }}{% endblock %}
<!-- main -->
{% block main %}
<div class="main-wrap">
    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{{ url_for('blue_manage.index') }}">首页</a><span class="crumb-step">&gt;</span><span class="crumb-name">作品管理</span></div>
    </div>
    <div class="search-wrap">
        <div class="search-content">
            <form action="#" method="post">
                <table class="search-tab">
                    <tr>
                        <th style="width: 90px">选择分类:</th>
                        <td>
                            <select name="search-sort" id="">
                                <option value="*" name="Categories">全部</option>
                                {% for CategoriesData in CategoriesDataList %}
                                    <option value="{{ CategoriesData.name }}" name="Categories">{{ CategoriesData.name }}</option>
                                {% endfor %}
                            </select>
                        </td>
                        <th style="width: 80px">选择标签:</th>
                        <td>
                            <select name="search-sort" id="">
                                <option value="*" name="tags">全部</option>
                                {% for TagsData in TagsDataList %}
                                    <option value="{{ TagsData.name }}" name="Categories">{{ TagsData.name }}</option>
                                {% endfor %}
                            </select>
                        </td>
                        <th style="width: 70px">关键字:</th>
                        <td><input class="common-text" placeholder="关键字" name="keywords" value="" id="" type="text"></td>
                        <td><input class="btn btn-primary btn2" name="sub" value="查询" type="submit"></td>
                    </tr>
                </table>
            </form>
        </div>
    </div>
    <div class="result-wrap">
        <form name="myform" id="myform" method="post">
            <a href="{{ url_for('blue_manage.PostsInsert') }}"><button type="button" class="btn btn-outline-primary"><i class="icon-font">&#xe026;</i> 新增作品</button></a>
            <button type="submit" class="btn btn-outline-primary" name="status" value="delete"><i class="icon-font">&#xe019;</i> 批量删除</button>
            <button type="submit" class="btn btn-outline-primary" name="status" value="release"><i class="icon-font">&#xe052;</i> 批量发布</button>
            <button type="submit" class="btn btn-outline-primary" name="status" value="draft"><i class="icon-font">&#xe002;</i> 转为草稿</button>
            <div class="result-content">
                <table class="table table-bordered">
                  <thead>
                    <tr>
                        <th style="width: 1%"><input class="allChoose" type="checkbox" onchange="SelectALL(this)"></th>
                        <th style="width: 2%" scope="col">ID</th>
                        <th scope="col">文章标题</th>
                        <th scope="col">状态</th>
                        <th scope="col">文章作者</th>
                        <th scope="col">分类</th>
                        <th scope="col">标签</th>
                        <th scope="col">访问统计</th>
                        <th scope="col">创建时间</th>
                        <th scope="col">修改时间</th>
                        <th scope="col">操作</th>
                    </tr>
                  </thead>
                  <tbody>
                  {% for post in posts %}
                    <tr>
                        <td style="width: 1%"><input class="allChoose" name="PostsID" value="{{ post.id }}" type="checkbox"></td>
                        <!-- 文章ID  -->
                        <td style="width: 2%">{{ post.id }}</td>
                        <!-- 文章标题 -->
                        <td><a href="{{ url_for('blue_blog.read', blog_id=post.id) }}" target="_blank">{{ post.title }}</a></td>
                        <td>
                        <!-- 0:已发布,1:审核中,2:编辑中,3:草稿 -->
                            {% if post.status == 0 %}
                                <a>已发布</a>
                            {% elif post.status == 1 %}
                                <a>审核中</a>
                            {% elif post.status == 2 %}
                                <a>编辑中</a>
                            {% elif post.status == 3 %}
                                <a>草稿</a>
                            {% endif %}
                        </td>
                        <td>{{ post.author }}</td>
                        <td>
                        {% for categorie in categories %}
                            {% if post.id == categorie.post_id %}
                                <span class="badge badge-secondary" style="background-color: {{ categorie.color }}"><a style="color: #ffffff" href="{{ url_for('blue_manage.categories', categories_name=categorie.slug ) }}">{{ categorie.name }}</a></span>
                            {% endif %}
                        {% endfor %}
                        </td>
                        <td>
                        {% for tag in tags %}
                            {% if post.id == tag.post_id %}
                                <span class="badge badge-secondary" style="background-color: {{ tag.color }}"><a style="color: #ffffff" href="{{ url_for('blue_manage.tag', tag_name=tag.slug ) }}">{{ tag.name }}</a></span>
                            {% endif %}
                        {% endfor %}
                        </td>
                        <td>{{ post.access_count }}</td>
                        <td>{{ post.create_time }}</td>
                        <td>{{ post.update_time }}</td>
                        <td>
                            <a href="{{ url_for('blue_manage.PostsEdit', posts_id=post.id) }}">编辑</a>
                            <a href="{{ url_for('blue_manage.links', posts_id=post.id) }}">删除</a>
                        </td>
                    </tr>
                  {% endfor %}
                  </tbody>
                </table>
            <!-- 设置分页 -->
            <nav aria-label="Page navigation example">
                <ul class="pagination">
                    <!-- 显示分页信息 -->
                    <li class="page-item">
                        <a class="page-link">共{{ posts.total }}篇</a>
                    </li>

                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('blue_manage.posts', page=posts.prev_num) }}" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
                    </li>
                {% for page_num in posts.iter_pages() %}
                    {% if posts.page == page_num %}
                        <li class="page-item active">
                            <a class="page-link" href="{{ url_for('blue_manage.posts', page=page_num) }}">{{ page_num }}</a>
                        </li>
                    {% else %}
                        <li class="page-item">
                            <a class="page-link" href="{{ url_for('blue_manage.posts', page=page_num) }}">{{ page_num }}</a>
                        </li>
                    {% endif %}
                {% endfor %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('blue_manage.posts', page=posts.next_num) }}" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
                    </li>
                </ul>
            </nav>
            </div>
        </form>
    </div>
</div>
{% endblock %}
